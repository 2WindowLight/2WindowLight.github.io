---
title: <h0>VMware NSX Module 4 NSX Lesson 1 Overview of Logical Switching Architecture</h0>
author: cotes 
categories: [cisco virtual cloud,2025-03-18-cisco]
tags: [Network, Cloud, NSX]









---



## **NSX에서 Layer 2 스위칭의 중요성**



**1. 개요**

NSX에서 **Layer 2 스위칭**을 구축하고 실행하려면, 전체 아키텍처와 논리적 스위칭(Logical Switching)에 관여하는 구성 요소를 이해해야 한다. NSX는 기존 물리적 네트워크와 달리 소프트웨어 기반의 가상 네트워크 환경을 제공하며, 이를 통해 네트워크 세분화와 확장성을 제공한다.



------

**2. 주요 개념**

​	•	**논리적 스위칭(Logical Switching)**

→ 물리적 네트워크와 독립적으로 운영되며, VM 간 Layer 2 네트워크 연결을 제공함.

​	•	**세그먼트(Segment)**

→ 기존 VLAN의 개념을 확장한 가상 네트워크로, NSX에서 Layer 2 연결을 제공하는 기본 단위.

​	•	**세그먼트 프로필(Segment Profiles)**

→ 세그먼트의 보안 및 트래픽 정책을 정의하는 설정 모음. 예: MAC 필터링, IP 필터링.

​	•	**Geneve(Generic Network Virtualization Encapsulation)**

→ NSX에서 사용하는 네트워크 가상화 터널링 프로토콜. 기존 VXLAN보다 더 유연하고 확장성이 높음.



------

**3. NSX의 Layer 2 기능을 활용하려면 필요한 작업**

​	•	**NSX의 Layer 2 기능 배포(Deploy)**

→ 논리적 스위치를 설정하고, 네트워크 세그먼트를 정의함.

​	•	**설정(Configure)**

→ VM과 호스트가 동일한 Layer 2 세그먼트에서 통신할 수 있도록 연결 구성.

​	•	**관리(Manage)**

→ 세그먼트 프로필을 통해 보안 및 트래픽 정책을 최적화하고, Geneve를 활용하여 네트워크 가상화를 수행함.



------

**4. 핵심 요점**

​	•	NSX의 **Layer 2 스위칭은 기존 물리적 네트워크를 가상화하여 네트워크 확장성과 유연성을 높이는 역할**을 함.

​	•	**Geneve 프로토콜을 활용**하여 NSX 환경에서 VM 간의 논리적 네트워크를 구성할 수 있음.

​	•	세그먼트와 세그먼트 프로필을 이해하고 적절히 활용해야 **보안과 성능을 최적화**할 수 있음.



------

# Lesson 1: Overview of Logical Switching Architecture

------



## **NSX 논리적 스위칭(Logical Switching)의 활용 사례**



![image-20250318144241938](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318144241938.png)

1. **기존 데이터 센터 스위칭의 문제점**



기존 물리적 데이터 센터 환경에서는 Layer 2(스위칭) 및 Layer 3(라우팅) 인프라를 운영하는 데 다양한 문제점이 존재한다.

​	•	**멀티테넌트 또는 애플리케이션 세분화 문제**

→ 서로 다른 테넌트(고객) 또는 애플리케이션을 분리하려면 VLAN을 설정해야 하며, 이는 확장성에 한계가 있음.

​	•	**VM 이동성(모빌리티) 문제**

→ 가상 머신(VM)이 데이터 센터 내에서 이동할 경우, 동일한 Layer 2 네트워크에서만 원활한 통신이 가능함.

​	•	**STP(Spanning Tree Protocol)로 인한 대규모 Layer 2 물리 네트워크 확장 문제**

→ STP는 네트워크 루프를 방지하기 위해 특정 경로를 차단하므로, 트래픽 경로 최적화가 어려움.

​	•	**하드웨어 메모리 테이블(MAC 및 FIB 테이블) 제한**

→ 스위치 및 라우터의 하드웨어가 처리할 수 있는 MAC 주소 및 포워딩 테이블(FIB)의 크기 한계로 인해 확장성이 제한됨.



------

2. **NSX 논리적 스위칭의 장점**



NSX의 논리적 스위칭 기능은 기존 Layer 2 물리적 네트워크의 한계를 해결하며, 보다 유연한 네트워크 구성을 가능하게 한다.

​	•	**데이터 센터 전반에서 확장 가능한 멀티테넌시(Multitenancy) 지원**

→ 하나의 물리적 네트워크 인프라에서 여러 고객 또는 애플리케이션을 논리적으로 분리할 수 있음.

​	•	**기존 물리적 네트워크 토폴로지를 그대로 활용 가능**

→ 새로운 네트워크 장비를 추가하지 않고 기존 환경에서 가상 네트워크를 구축할 수 있음.

​	•	**Layer 3 인프라에서 Layer 2 오버레이 네트워크 지원**

→ NSX의 Geneve, VXLAN과 같은 오버레이 기술을 활용하여 L3 네트워크 위에서 L2 네트워크를 구성할 수 있음.

​	•	**물리적 호스트와 네트워크 스위치를 넘나드는 세그먼트(Segment) 지원**

→ 특정 네트워크 세그먼트가 여러 호스트와 네트워크 장비를 통해 확장될 수 있음.



------

**3. 그림 설명**



위의 그림은 **기존 데이터 센터(Traditional Data Center)**와 **NSX 기반의 논리적 스위칭 환경(NSX Logical Switching)**을 비교한 것이다.

* **전통적인 데이터 센터**(상단)
  * Layer 2 및 Layer 3 네트워크가 물리적 장비에 종속됨.
  * VM 간 이동성을 보장하기 어려움.
  * 대규모 확장 시 물리적 네트워크 복잡성이 증가함.

* **NSX 환경**(하단)
  * 논리적 세그먼트(Segment 1, 2, 3)를 생성하여 트래픽을 유연하게 관리할 수 있음.
  * 물리적 네트워크를 변경하지 않고도 VM 간 Layer 2 연결을 유지할 수 있음.
  * 오버레이 네트워크를 활용하여 L2 네트워크를 L3 인프라에서 운영 가능함.



**결론**

NSX의 논리적 스위칭 기능은 기존 물리적 네트워크의 제약을 극복하고, 더 유연하고 확장성 높은 가상 네트워크를 제공한다. 기존 네트워크를 유지하면서도 멀티테넌시, VM 이동성, 확장성 등의 문제를 효과적으로 해결할 수 있다.

------

------

## **논리적 스위칭(Logical Switching) 개요**

![image-20250318145856243](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318145856243.png)

논리적 스위칭은 NSX 가상 환경에서 L2 네트워크 기능을 제공하는 중요한 개념이다. 이는 물리적인 네트워크 스위칭을 소프트웨어 기반으로 구현한 것으로, 여러 가상 머신(VM), 컨테이너, 라우터 등을 동일한 논리적 네트워크(Segment)에 연결하여 통신할 수 있도록 한다.



------



**1. 주요 개념**



1) 세그먼트(Segment)
   * **세그먼트(또는 논리적 스위치)**는 VLAN과 유사한 역할을 하며, 네트워크를 논리적으로 분리하는 기능을 한다.
   * 세그먼트는 각 가상 머신(VM)과 같은 네트워크 엔티티가 연결될 수 있는 가상의 네트워크 인터페이스 역할을 한다.
   * 물리적 네트워크의 VLAN과 다르게 **VNI(Virtual Network Identifier)**라는 고유 식별자를 가진다.
   * **VLAN과의 차이점**: VLAN은 4096개까지만 가능하지만, NSX 세그먼트는 VNI를 사용하여 수십만 개의 네트워크를 생성할 수 있다.



2) **세그먼트 포트(Segment Ports)**
   * 세그먼트 내에서 가상 머신(VM), 컨테이너, 라우터 등이 연결되는 인터페이스를 의미한다.
   * 각 엔티티(예: VM, 컨테이너)는 세그먼트 포트를 통해 연결되며, 동일한 세그먼트에 있는 다른 엔티티와 통신 가능하다.



3) **세그먼트 프로파일(Segment Profiles)**
   * 세그먼트 또는 세그먼트 포트에 적용되는 네트워크 정책을 정의하는 프로파일이다.
   * **주요 프로파일 유형**
     * **IP Discovery**: 네트워크에서 IP 주소를 학습하는 기능
     * **MAC Discovery**: MAC 주소를 학습하고 관리하는 기능
     * **SpoofGuard**: MAC 및 IP 스푸핑 공격을 방지하는 기능
     * **Segment Security**: ACL 및 기타 보안 정책을 적용하는 기능
     * **Quality of Service (QoS)**: 트래픽 우선순위를 조정하여 네트워크 성능을 최적화하는 기능



------



**2. NSX에서 논리적 스위칭이 동작하는 방식**

1. **가상 머신(VM)과 컨테이너가 세그먼트에 연결된다.**
   * NSX는 가상 분산 스위치(VDS 또는 N-VDS)를 사용하여 세그먼트를 설정한다.
   * 가상 머신 및 컨테이너가 해당 세그먼트의 포트(Segment Port)에 연결된다.

2. **세그먼트 포트를 통해 엔티티 간 통신이 가능하다.**
   * 동일한 세그먼트(VNI) 내에서는 VM 간 L2 통신이 가능하다.
   * 터널링 기술(Geneve)을 사용하여 서로 다른 호스트에 있는 VM 간 통신을 지원한다.

3. **세그먼트 프로파일을 활용하여 네트워크 정책을 적용한다.**
   * ACL, QoS, 보안 정책 등을 세그먼트 레벨 또는 포트 레벨에서 설정할 수 있다.



------



3. **그림 설명**

   위 그림을 보면, NSX 환경에서 **웹 세그먼트(Web-Segment)**가 설정되어 있으며, 여러 개의 가상 머신(VM)과 컨테이너가 이 세그먼트에 연결되어 있다.

   * **세그먼트(VNI: 73728)**: 논리적으로 분리된 네트워크 환경
   * **세그먼트 포트(P1~P7)**: VM 및 컨테이너가 세그먼트에 연결되는 인터페이스

   * **VDS(Virtual Distributed Switch)**: ESXi 트랜스포트 노드에서 L2 네트워크 기능을 제공하는 가상 스위치
   * **Tier-0/Tier-1 Gateway**: 외부 네트워크와 연결하는 라우팅 게이트웨이
   * **정책(Policy) 관리**: NSX Manager에서 세그먼트, 세그먼트 포트, 세그먼트 프로파일을 설정하고 관리



------



4. **논리적 스위칭의 주요 장점**

   1. **확장성 높은 네트워크 구성**
      * VNI를 사용하여 VLAN보다 더 많은 네트워크를 생성 가능

   2. **L2 over L3 네트워크 지원**
      * Overlay 네트워크를 활용하여 L3 네트워크 위에서 L2 통신이 가능

   3. **자동화 및 중앙 관리**
      * NSX Manager에서 중앙에서 논리적 스위치를 제어하고 정책을 설정 가능

   4. **보안 강화**
      * ACL, SpoofGuard, MAC/IP Discovery 등의 보안 정책을 쉽게 적용 가능



------

**결론**

NSX 논리적 스위칭을 활용하면 기존 물리적 네트워크에서의 제약을 극복하고, 보다 유연하고 확장성 높은 가상 네트워크를 구성할 수 있다. 세그먼트와 세그먼트 포트를 통해 VM 및 컨테이너 간의 네트워크 연결이 가능하며, NSX Manager를 통해 일관된 정책을 적용하고 제어할 수 있다.

------

------

## **세그먼트(Segment) 개요**

![image-20250318150154207](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318150154207.png)

세그먼트는 **NSX에서 제공하는 L2 브로드캐스트 도메인**으로, 기존 VLAN과 유사한 기능을 수행하지만 **VNI(Virtual Network Identifier)** 를 사용하여 네트워크를 구분한다.



**주요 특징**

​	•	동일한 세그먼트에 속한 VM들은 서로 통신할 수 있음.

​	•	세그먼트는 **ESXi Transport Node 간 터널을 통해** 데이터를 전달할 수 있음.

​	•	VLAN 대신 VNI를 사용하여 확장성이 뛰어남.



------



**그림 설명**



해당 그림에서는 두 개의 **ESXi Transport Node(A, B)** 가 존재하며, 각 노드에 하나의 **워크로드(Workload)** VM이 배치되어 있다.

* **ESXi Transport Node A**
  * 172.16.20.10 IP를 가진 워크로드(VM) 포함.

* **ESXi Transport Node B**
  * 172.16.20.11 IP를 가진 워크로드(VM) 포함.
  * **두 노드 간의 연결**
  * 두 노드는 **세그먼트를 통해 연결**되어 있으며, 동일한 네트워크 환경에서 통신 가능.
  * **NSX의 Overlay 터널**을 통해 물리적 네트워크 구조와 관계없이 통신함.



------



**핵심 요약**

​	1.	세그먼트는 **NSX의 논리적 L2 네트워크**이며, VNI를 기반으로 작동함.

​	2.	동일한 세그먼트에 속한 VM들은 **ESXi Transport Node가 다르더라도 통신 가능**.

​	3.	**Overlay 터널 기술**을 통해 데이터센터 전반에서 네트워크 연결을 유지함.



------

------



**About Segments(세그먼트) (2)**



세그먼트의 유형은 해당 세그먼트가 연결된 **트랜스포트 존(Transport Zone)** 에 따라 달라진다.

트랜스포트 존은 세그먼트의 적용 범위를 정의하며, **오버레이(Overlay) 기반** 또는 **VLAN 기반** 트랜스포트 존에서 생성될 수 있다.



**주요 개념**

1. **트랜스포트 존과 세그먼트 관계**
   * 세그먼트는 특정 **트랜스포트 존(Transport Zone)** 에 연결되며, 트랜스포트 존이 세그먼트의 범위를 결정함.
   * 트랜스포트 존에 따라 **오버레이 기반 세그먼트** 또는 **VLAN 기반 세그먼트**로 생성됨.

2. **세그먼트 유형**

   * **오버레이(Overlay) 기반 세그먼트**
     * *NSX Geneve 터널** 을 사용하여 **ESXi 호스트 간 네트워크 연결** 을 제공.
     * vCenter에서는 **NSX 분산 포트 그룹(NSX Distributed Port Group)** 으로 생성됨.

   * **VLAN 기반 세그먼트**
     * 기존 L2 네트워크(VLAN)와 연동하여 동작.
     * 물리적인 스위치 기반 VLAN과 연결됨.

3. **세그먼트 연결 및 관리**
   * **VM, 컨테이너 등의 워크로드(Workloads)** 는 **세그먼트 포트(Segment Port)** 를 통해 연결됨.
   * **NSX UI 및 API** 에서만 세그먼트 구성 변경 가능.



------

------

## **About Tunneling(터널링) 개요**

![image-20250318152343225](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318152343225.png)

터널링은 가상 네트워크 트래픽을 캡슐화하여 물리 네트워크를 통해 데이터를 전송하는 방식이다. NSX는 Geneve 프로토콜을 사용하여 데이터를 캡슐화한다.



------



**주요 개념**

1. **Geneve 기반 캡슐화**
   * NSX는 Geneve를 사용하여 가상 머신(VM) 트래픽을 캡슐화함.
   * VM 프레임은 Geneve 터널 헤더를 포함하여 터널을 통해 전송됨.

2. **터널 엔드포인트(TEP, Tunnel Endpoint)**
   * 터널은 터널 엔드포인트(TEP) 간에 설정됨.
   * TEP는 캡슐화된 트래픽을 송수신하는 노드의 IP 주소를 나타냄.
   * TEP는 VM 트래픽과 제어(헬스 체크) 트래픽을 운반함.

3. **NSX 오버레이 네트워크**

   * 터널링을 활용하여 오버레이 네트워크와 언더레이 네트워크(물리 네트워크) 간의 분리를 제공함.
   * 오버레이 네트워크는 Geneve 헤더를 추가하여 데이터 프레임을 캡슐화하고 전달함.

   * 기본 전송 네트워크(Underlay Network)는 L2 네트워크일 수도 있고, L3 경계를 넘을 수도 있음.



------



**그림 설명**

위 그림에서는 NSX의 Geneve 기반 오버레이 터널링 구조를 보여줌.

​	•	Transport Node A와 Transport Node B가 터널 엔드포인트(TEP)로 동작함.

​	•	VM 트래픽은 Geneve 캡슐화를 거쳐 터널을 통해 이동함.

​	•	dvs-SA-Datacenter(VDS)를 활용하여 논리 네트워크를 연결함.

​	•	터널을 통해 서로 다른 물리적 호스트 간 VM 간의 통신이 가능함.



------

------

**About Geneve(제네브)**

![image-20250318154429779](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318154429779.png)



Geneve는 IETF에서 정의한 오버레이 터널링 기법으로, **L2 데이터를 L3 네트워크를 통해 캡슐화하여 전송** 하는 프로토콜이다.



------



**주요 개념**

1. **Geneve 캡슐화 방식**
   * 송신 TEP(Tunnel Endpoint)에서 VM의 프레임을 Geneve 헤더로 캡슐화.
   * 캡슐화된 UDP 패킷은 **포트 6081** 을 통해 목적지 TEP로 전송.
   * 목적지 TEP에서 Geneve 헤더를 제거하고, 원래 프레임을 대상 VM으로 전달.

2. **NSX에서의 Geneve 활용**
   * NSX는 **Geneve 기반의 터널링** 을 사용하여 네트워크 오버레이를 구성.
   * **VXLAN, NVGRE, STT** 와 같은 기존 터널링 기술과 비교하여 더 유연한 구조 제공.
   * Geneve 프로토콜은 **데이터 플레인 패킷만 캡슐화** 함.

3. **Geneve 패킷 전송 방식**
   * Geneve-캡슐화된 패킷은 **백플레인, 스위치, 라우터를 통해 전달** 됨.
   * 단일 TEP에서 **여러 TEP로 유니캐스트 전송** 지원.
   * 애플리케이션 및 VM에 영향을 주지 않으며, 네트워크 터널링을 통해 통신 가능.

4. **Geneve 터널링 특징**
   * 표준 UDP 패킷으로 전송되며 **IPv4 및 IPv6** 지원.
   * 목적지 TEP에서 Geneve 헤더를 제거하고 **원래 프레임을 목적지로 전달**.
   * **ECMP(Equal-Cost Multipath)** 및 **NIC 하드웨어 오프로드 기능** 을 활용하여 효율적인 운영 가능.



------



**그림 설명**



해당 그림은 **NSX에서 Geneve 터널을 활용한 데이터 전송 방식** 을 나타낸다.

​	•	**송신 TEP** 는 VM 프레임을 **Geneve 헤더로 캡슐화** 하여 **UDP 포트 6081** 을 통해 **목적지 TEP로 전달**.

​	•	**목적지 TEP** 는 Geneve 헤더를 제거한 후, **원본 프레임을 대상 VM으로 전송**.

​	•	Geneve 터널링을 통해 **L2 네트워크를 L3 인프라 위에서 구현 가능**.



------

------

## **Geneve Header Format(제네브 헤더 형식)**

![image-20250318154819951](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318154819951.png)





------







Geneve 프로토콜은 터널링을 위한 새로운 접근 방식을 제공하며, **터널 엔드포인트 간 제어 평면(Control Plane) 독립성** 을 유지할 수 있도록 설계되었다.



------



**주요 개념**

1. **Geneve 프로토콜 특성**
   * **UDP 기반** 으로 동작하며 **8바이트 UDP 헤더 추가**.
   * **포트 번호 6081** 사용.
   * **24비트 VNI(Virtual Network Identifier)** 를 통해 세그먼트 구분.
   * **Wireshark 및 tcpdump** 도구에서 지원.
   * 네트워크 가상화를 지원하기 위해 **오버레이 및 언더레이 네트워크의 기능을 최대한 활용** 함.

2. **Geneve 터널링 요구 사항**
   * 데이터 플레인이 유연하고 확장 가능하여 **현재 및 미래의 제어 평면과 호환 가능** 해야 함.
   * 하드웨어 및 소프트웨어 모두에서 효율적으로 구현될 수 있도록 설계.
   * 기존 IP 주소를 통한 **고성능 데이터 전송 지원**.

3. **Geneve 패킷 구조**

   * Geneve 패킷은 **UDP를 통해 IPv4 또는 IPv6 상에서 캡슐화됨**.

   * **작고 고정된 터널 헤더** 를 통해 제어 정보를 포함하고, 향후 기능 확장을 위한 **가변 옵션 필드** 제공.

   * 페이로드는 **이더넷 프레임과 같은 프로토콜 데이터 단위(PDU)를 포함**.



------



**Geneve 헤더 필드 설명**

| **필드**                            | **크기(비트)** | **설명**                                      |
| ----------------------------------- | -------------- | --------------------------------------------- |
| **Version**                         | 2              | 현재 버전(0)                                  |
| **Options Length**                  | 6              | 가변 옵션 길이 (최소 8바이트, 최대 260바이트) |
| **O (OAM 패킷)**                    | 1              | 제어 메시지 포함 여부 표시                    |
| **C (Critical 옵션 여부)**          | 1              | 중요 옵션 포함 여부                           |
| **Reserved**                        | 6              | 예약된 필드(전송 시 0)                        |
| **Protocol Type**                   | 16             | Geneve 헤더 이후의 데이터 유형 지정           |
| **Reserved**                        | 8              | 예약된 필드(전송 시 0)                        |
| **Virtual Network Identifier(VNI)** | 24             | 세그먼트 구분을 위한 네트워크 ID              |
| **Variable Length Options**         | 가변           | 타입-길이-값(TLV) 형식의 추가 옵션            |





------



**그림 설명**



해당 그림은 **Geneve 헤더 구조** 를 나타낸다.

​	•	**Version, 옵션 길이, OAM 필드, 프로토콜 유형 등 주요 필드 포함**.

​	•	**VNI(Virtual Network Identifier)** 를 통해 각 네트워크를 고유하게 식별.

​	•	**가변 옵션 필드** 를 활용하여 확장 가능성을 제공.



------



**Geneve 프로토콜의 장점**

​	•	**유연한 메타데이터 삽입 가능** (TLV 필드 활용).

​	•	**표준 개정 없이 새로운 기능 추가 가능**.

​	•	**하드웨어 의존성 없이 소프트웨어 기반 기능 개발 가능**.

​	•	**VXLAN과 동일한 NIC 오프로드 기능 제공** (호환 목록 확인 필요).

​	•	**Wireshark 등 타사 네트워크 분석 도구에서 해석 가능**.

------

------

## **Logical Switching: End-to-End Communication(논리적 스위칭: 종단 간 통신)**



![image-20250318154944119](/assets/cisco_post_img/2025-03-18-VMware NSX Module 4: NSX Logical Switching//image-20250318154944119.png)

------

같은 세그먼트에 연결된 두 개의 VM은 종단 간(end-to-end)으로 통신할 수 있다.



------



**구성 요소 및 개념**

1. **트랜스포트 노드 A(sa-esxi-01)**

   * **vSphere Distributed Switch(dvs-SA-Datacenter)** 를 **호스트 스위치** 로 사용.

   * **TEP(Tunnel Endpoint) IP:** 172.20.11.51.

   * **VMkernel 인터페이스 VMK10** 이 생성됨.
   * **VM-1** 실행 중 (IP: 10.1.10.11, MAC: ABC).

2. **트랜스포트 노드 B(sa-esxi-02)**
   * **vSphere Distributed Switch(dvs-SA-Datacenter)** 를 **호스트 스위치** 로 사용.
   * **TEP(Tunnel Endpoint) IP:** 172.20.11.52.
   * **VMkernel 인터페이스 VMK10** 이 생성됨.
   * **VM-2** 실행 중 (IP: 10.1.10.12, MAC: DEF).

3. **세그먼트 구성**
   * **Web-Segment 69632** 를 통해 VM-1과 VM-2가 연결됨.
   * 이 **Web-Segment** 는 오버레이 기반 세그먼트로 **PROD-OVERLAY-TZ** 트랜스포트 존에 구성됨.



------



**VM-1에서 VM-2로의 통신 과정**

​	1.	**VM-1이 Web-Segment로 트래픽을 전송**.

​	2.	**소스 하이퍼바이저가 Geneve 헤더를 추가하여 패킷을 캡슐화**.

​	3.	**소스 트랜스포트 노드가 물리 네트워크를 통해 패킷을 전달**.

​	4.	**목적지 트랜스포트 노드가 패킷을 수신하고 디캡슐화 수행**.

​	5.	**목적지 TEP가 L2 프레임을 VM-2로 전달**.



------



**그림 설명**



해당 그림은 **Geneve 기반 논리적 스위칭을 활용한 VM 간 통신 과정** 을 나타낸다.

​	•	VM-1과 VM-2가 **오버레이 기반 Web-Segment 69632** 를 통해 연결됨.

​	•	각 트랜스포트 노드는 **TEP(Tunnel Endpoint)** 를 사용하여 Geneve 캡슐화를 수행.

​	•	**Geneve-Encapsulated Packet** 이 L2/L3 네트워크 인프라를 통해 전달됨.



------



**결론**

​	•	**Geneve 터널을 활용한 논리적 스위칭** 을 통해 물리적 네트워크에 관계없이 VM 간 통신이 가능.

​	•	**오버레이 네트워크** 를 통해 확장성과 유연성을 제공.

​	•	**TEP(Tunnel Endpoint)와 Geneve 캡슐화** 를 사용하여 ESXi 트랜스포트 노드 간 패킷 전달 수행



------

------

