---
title: <h0>BGP Basic 2</h0>
author: cotes   
categories: [cisco virtual cloud, 2025-02-18-cisco]
tags: [Network, BGP]







---

# BGP Basic 2



**BGP ì„¤ì • ìˆœì„œ**

1. **IGP ì„¤ì • (IBPG ì„¤ì •)**

2. **BGP ì„¤ì •**

   - **IBGP**
   - **EBGP**
   - **BGP ì´ìŠˆ í•´ê²° (next hop, horizon)**

3. **BGP ê²½ë¡œ ì¡°ì •**

   - **BGP attribute(p.434)**

     **a. origin (i > e > ?) <- ìš°ì„ ìˆœìœ„**

     **b. AS path - ê±°ì³ì˜¨ AS ë²ˆí˜¸ (AS ì„¸íŠ¸, AS ì‹œí€€ìŠ¤ )408p**

     c. MED

     

     



------



### BGP ì„¤ì •ì‹œ í•´ê²°í•´ì•¼í•  ë¬¸ì œ

1. **next hop ë¬¸ì œ**

   - **ë¼ìš°íŒ…**

   - **ëª…ë ¹ì–´(next-hop-self)**

2. **split horizon ë¬¸ì œ**
   - **fulle mesh**
   - **confederation**: **ì‚¬ì„¤ as ì‚¬ìš©**
   - **route reflector**



------

## BGP ë„¥ìŠ¤íŠ¸ í™‰ 

ëª©ì ì§€ì˜ ë„¤íŠ¸ì›Œí¬ë¡œ ê°€ê¸° ìœ„í•œ ë‹¤ìŒ ë¼ìš°í„°ë¥¼ ë„¥ìŠ¤íŠ¸ í™‰ ë¼ìš°í„°ë¼ê³  í•œë‹¤.

IGPì˜ ë„¥ìŠ¤íŠ¸ í™‰ IP ì£¼ì†ŒëŠ” í•­ìƒ ë¬¼ë¦¬ì ìœ¼ë¡œ ì ‘ì†ëœ ì¸ì ‘ ë¼ìš°í„°ì˜ IP ì£¼ì†Œì´ë‹¤.

![IMG_0515](/assets/cisco_post_img/2025-02-18-BGP Attribute/IMG_0515.jpeg)



ë‹¤ë¥¸ ASë¡œ ë„˜ì–´ê°ˆ ë•ŒëŠ” ê·¸ ASì™€ ì—°ê²°ë˜ëŠ” ë¼ìš°í„°ê°€ ë„¥ìŠ¤íŠ¸ í™‰ì´ ëœë‹¤.

![IMG_0510](/assets/cisco_post_img/2025-02-18-cisco/IMG_0510.jpeg)

ë©€í‹° ì—‘ì„¸ìŠ¤ ë„¤íŠ¸ì›Œí¬ì—ì„œëŠ” ë‹¤ìŒ ê·¸ë¦¼ ì²˜ëŸ¼ eBGP, IBGPë¥¼ ë§‰ë¡ í•˜ê³  ì²˜ìŒ ë¼ìš°íŒ… ì •ë³´ë¥¼ ë³´ë‚¸ ë¼ìš°í„°ê°€ ë„¥ìŠ¤íŠ¸ í™‰ìœ¼ë¡œ ì„¤ì •ë˜ê³ , ëê¹Œì§€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.



![IMG_0511](/assets/cisco_post_img/2025-02-18-cisco/IMG_0511.jpeg)

BGPì—ì„œ ë„¥ìŠ¤íŠ¸ í™‰ì˜ IP ì£¼ì†ŒëŠ” ë„¤ì´ë²„ë¥¼ ì„¤ì •í•  ë•Œ ì‚¬ìš©ëœ IPë¥¼ ì‚¬ìš©í•œë‹¤.

ë˜í•œ BGPëŠ” ê´‘ê³ ë°›ì€ ë„¤íŠ¸ì›Œí¬ì˜ ë„¥ìŠ¤íŠ¸ í™‰ ã…ˆì†Œê°€ ë¼ìš°íŒ… ê°€ëŠ¥í•œ ê²ƒì´ì–´ì•¼ë§Œ í•´ë‹¹ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.

------

## next-hop-self ì˜µì…˜ ì‚¬ìš© 385

ì´ ë°©ë²•ì€ ë¼ìš°í„°ì¸ R2ê°€ ë„¤ì´ë²„ë¥¼ ì„¤ì •í•˜ë©´ì„œ, ë„¥ìŠ¤íŠ¸ í™‰ ip ì£¼ì†Œë¥¼ R3, R4 ë¼ìš°í„°ê°€ ì•Œê³  ìžˆëŠ” R2 ìžì‹ ì˜ ì£¼ì†Œë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì´ë‹¤.

â€‹	â€¢	BGPì—ì„œ **IBGP(ë‚´ë¶€ BGP) ë¼ìš°í„° ê°„ì— Next Hop ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì„¤ì •**

â€‹	â€¢	**íŠ¹ì • ë¼ìš°í„°ê°€ ìžì‹ ì˜ ì¸í„°íŽ˜ì´ìŠ¤ IPë¥¼ ë„¥ìŠ¤íŠ¸ í™‰ìœ¼ë¡œ ê°•ì œ ì„¤ì •**í•˜ì—¬, IBGP ë‚´ë¶€ì—ì„œ ì˜¬ë°”ë¥´ê²Œ íŒ¨í‚·ì´ ì „ë‹¬

âœ… **ì‚¬ìš© ì´ìœ **

â€‹	1.	**IBGPì—ì„œ Next Hopì´ AS ë‚´ë¶€ ë¼ìš°í„°ì˜ ì¸í„°íŽ˜ì´ìŠ¤ê°€ ì•„ë‹Œ ì™¸ë¶€(EBGP) IPë¡œ ì„¤ì •ë  ê²½ìš°, ê²½ë¡œê°€ ëŠê¸¸ ìˆ˜ ìžˆìŒ.**

â€‹	2.	**Next Hopì„ AS ë‚´ë¶€ ë¼ìš°í„°ì˜ ì¸í„°íŽ˜ì´ìŠ¤ë¡œ ë³€ê²½í•˜ì—¬ ê²½ë¡œ ë¬¸ì œë¥¼ ë°©ì§€**í•˜ê¸° ìœ„í•´ ì‚¬ìš©.

![IMG_0511](/assets/cisco_post_img/2025-02-18-cisco/IMG_0511-9843490.jpeg)



### ë„¥ìŠ¤íŠ¸ í™‰ ip ì£¼ì†Œ ë³€ê²½í•˜ê¸°

```bash
router bpg 234
neighbor 1.1.3.3 next-hop-self
neighbor 1.1.4.4 next-hop-self
```

ê·¸ëŸ¬ë©´, R3ì™€ R4ê°€ R2ì—ì„œ ìˆ˜ì‹ í•˜ëŠ” ëª¨ë“  ë„¤íŠ¸ì›Œí¬ì˜ ë„¥ìŠ¤íŠ¸ í™‰ì´ R2ë¡œ ë³€ê²½ëœë‹¤.



**ì¶”ê°€) ê²½ê³„ ë¼ìš°í„°(Border Router)ì™€ì˜ ê´€ê³„**

â€‹	â€¢	**ASBR(Autonomous System Boundary Router):**

â€‹	â€¢	OSPFì™€ BGP ê°™ì€ í”„ë¡œí† ì½œì—ì„œ **ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ì™€ ì—°ê²°ë˜ëŠ” ê²½ê³„ ë¼ìš°í„°**.

â€‹	â€¢	ASBRì´ ì™¸ë¶€ ë¼ìš°í„°ì—ì„œ ë°›ì€ ê²½ë¡œ ì •ë³´ë¥¼ ë‚´ë¶€ ë¼ìš°í„°ì— ì „ë‹¬í•  ë•Œ **Next Hopì´ í•„ìš”**.

â€‹	â€¢	**ABR(Area Border Router):**

â€‹	â€¢	OSPFì—ì„œ ì„œë¡œ ë‹¤ë¥¸ Areaë¥¼ ì—°ê²°í•˜ëŠ” ë¼ìš°í„°.

â€‹	â€¢	OSPF ë‚´ë¶€ì—ì„œë„ ABRì„ í†µí•´ ë‹¤ë¥¸ Areaë¡œ íŒ¨í‚·ì„ ì „ë‹¬í•  ë•Œ **Next Hop ê°œë…ì´ ì ìš©ë¨**.



âœ… **ASBRê³¼ ABRì—ì„œë„ Next Hop Selfê°€ ì ìš©ë  ìˆ˜ ìžˆìŒ.**

â€‹	â€¢	ASBRì´ BGPë¥¼ í†µí•´ ì™¸ë¶€ ê²½ë¡œë¥¼ í•™ìŠµí•  ë•Œ, ë‚´ë¶€ IBGP ë„¤ì´ë²„ë“¤ì—ê²Œ ìžì‹ ì˜ IPë¥¼ Next Hopìœ¼ë¡œ ê´‘ê³ í•˜ë©´ **ê²½ë¡œ ë¬¸ì œ í•´ê²° ê°€ëŠ¥**.

------

## ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œ

**1. ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œì´ëž€?**



âž¡ï¸ **ë¼ìš°íŒ… ë£¨í”„(ê²½ë¡œê°€ ë¬´í•œ ë°˜ë³µë˜ëŠ” ë¬¸ì œ)ë¥¼ ë°©ì§€í•˜ëŠ” ê¸°ìˆ **

âž¡ï¸ **â€œíŒ¨í‚·ì„ ë°›ì€ ì¸í„°íŽ˜ì´ìŠ¤ë¡œ ë‹¤ì‹œ ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤â€** ì›ì¹™ì„ ì ìš©í•˜ëŠ” ê²ƒ

**2. ì™œ í•„ìš”í•œê°€?**



âœ” **ë¼ìš°íŒ… ë£¨í”„(Routing Loop) ë¬¸ì œ í•´ê²°**

âœ” **ë¶ˆí•„ìš”í•œ íŠ¸ëž˜í”½ ë°©ì§€**

âœ” **ë„¤íŠ¸ì›Œí¬ ì•ˆì •ì„± í–¥ìƒ**

**3. ì˜ˆì œ (ì‰½ê²Œ ì´í•´í•˜ê¸°)**



**âœ… ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œì´ ì—†ì„ ë•Œ (ë¬¸ì œ ë°œìƒ)**



**1ï¸âƒ£ R1 â†’ R2 ì—ê²Œ 192.168.1.0/24 ë„¤íŠ¸ì›Œí¬ ì •ë³´ ì „ë‹¬**



**2ï¸âƒ£ R2ëŠ” ë‹¤ì‹œ R1ì—ê²Œ ê°™ì€ 192.168.1.0/24 ë„¤íŠ¸ì›Œí¬ ì •ë³´ë¥¼ ì „ë‹¬**



**3ï¸âƒ£ R1ì€ ìžì‹ ì´ ë³´ë‚¸ ì •ë³´ë¥¼ ë˜ ë°›ê²Œ ë˜ê³ , ë¼ìš°íŒ… ë£¨í”„ ë°œìƒ ê°€ëŠ¥ ðŸš¨**

**âœ… ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œ ì ìš© í›„**



âœ” R1 â†’ R2 ì—ê²Œ 192.168.1.0/24 ì „ë‹¬ âœ…

âœ” **R2ëŠ” R1ì—ê²Œ ë‹¤ì‹œ ê°™ì€ ì •ë³´ë¥¼ ë³´ë‚´ì§€ ì•ŠìŒ** âŒ

âœ” **ë¼ìš°íŒ… ë£¨í”„ ë°©ì§€ & íŠ¸ëž˜í”½ ê°ì†Œ** ðŸŽ¯

**4. ì–´ë””ì—ì„œ ì‚¬ìš©ë˜ë‚˜?**



âœ” **ê±°ë¦¬ ë²¡í„° í”„ë¡œí† ì½œ(RIP, EIGRP)ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì ìš©ë¨**

âœ” **OSPF & BGP ê°™ì€ ë§í¬ ìƒíƒœ í”„ë¡œí† ì½œì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠìŒ**

**5. ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œ ì„¤ì • ë°©ë²• (Cisco)**



âœ” **ë¹„í™œì„±í™”í•  ë•Œë§Œ ëª…ë ¹ì–´ ì‚¬ìš©**

```
interface Serial0/0
 no ip split-horizon
```

âœ” ê¸°ë³¸ì ìœ¼ë¡œ RIP, EIGRPì—ì„œëŠ” í™œì„±í™”ë˜ì–´ ìžˆìŒ âœ…

**6. í•µì‹¬ ì •ë¦¬**

| **ê°œë…**          | **ì„¤ëª…**                                       |
| ----------------- | ---------------------------------------------- |
| **ì •ì˜**          | íŒ¨í‚·ì„ ë°›ì€ ì¸í„°íŽ˜ì´ìŠ¤ë¡œ ë‹¤ì‹œ ë³´ë‚´ì§€ ì•ŠëŠ” ì›ì¹™ |
| **ëª©ì **          | ë¼ìš°íŒ… ë£¨í”„ ë°©ì§€ & ë¶ˆí•„ìš”í•œ íŠ¸ëž˜í”½ ì œê±°        |
| **ì ìš© í”„ë¡œí† ì½œ** | RIP, EIGRP (ê±°ë¦¬ ë²¡í„° ë¼ìš°íŒ…)                  |
| **ë¹„í™œì„±í™” ë°©ë²•** | no ip split-horizon (Cisco ìž¥ë¹„)               |

âœ… **í•œë§ˆë”” ìš”ì•½:** **â€œë¼ìš°íŒ… ì •ë³´ë¥¼ ë°›ì€ ì¸í„°íŽ˜ì´ìŠ¤ë¡œ ë‹¤ì‹œ ë³´ë‚´ì§€ ë§ˆë¼â€ â†’ ë£¨í”„ ë°©ì§€ & íŠ¸ëž˜í”½ ì ˆì•½** ðŸš€



------

390 ***

## ì™„ì „ ë©”ì‹œ (full mesh)

![IMG_0513](/assets/cisco_post_img/2025-02-18-cisco/IMG_0513.jpeg)

**1. BGP Full Meshëž€?**



âž¡ï¸ **IBGP(ë‚´ë¶€ BGP)ì—ì„œ ëª¨ë“  ë¼ìš°í„°ê°€ ì„œë¡œ ì§ì ‘ ë„¤ì´ë²„(Neighbor) ê´€ê³„ë¥¼ ë§ºì–´ì•¼ í•œë‹¤ëŠ” ê·œì¹™**

âž¡ï¸ **ì¦‰, í•œ AS(ìžìœ¨ ì‹œìŠ¤í…œ) ë‚´ì— ìžˆëŠ” ëª¨ë“  IBGP ë¼ìš°í„°ê°€ ì„œë¡œ ì§ì ‘ BGP ì—…ë°ì´íŠ¸ë¥¼ ì£¼ê³ ë°›ì•„ì•¼ í•œë‹¤.**

**2. ì™œ Full Meshê°€ í•„ìš”í• ê¹Œ?**



âœ” **IBGP ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œ(Split Horizon) ì›ì¹™ ë•Œë¬¸!**

âœ” **IBGPì—ì„œëŠ” ë¼ìš°íŒ… ì •ë³´ë¥¼ ë°›ì€ ë¼ìš°í„°ê°€ ë‹¤ë¥¸ IBGP ë„¤ì´ë²„ì—ê²Œ ë‹¤ì‹œ ì „ë‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤.**

âœ” ë”°ë¼ì„œ, **ëª¨ë“  IBGP ë¼ìš°í„°ê°€ ì§ì ‘ ë„¤ì´ë²„ ê´€ê³„ë¥¼ ë§ºì–´ì•¼ í•œë‹¤.**

**3. ìœ„ ê·¸ë¦¼ì„ ì˜ˆì‹œë¡œ ì„¤ëª…í•˜ê¸°**

**ðŸ“Œ ìƒí™©**

â€‹	â€¢	**R1ì€ AS 1** (ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬)

â€‹	â€¢	**R2, R3, R4ëŠ” AS 234 (í•˜ë‚˜ì˜ ë‚´ë¶€ AS)**

â€‹	â€¢	**R1ì—ì„œ ë°›ì€ ë„¤íŠ¸ì›Œí¬ 1.1.1.0ì„ AS 234 ì „ì²´ì— í¼ëœ¨ë ¤ì•¼ í•¨**



**âŒ Full Meshê°€ ì—†ì„ ë•Œ ë¬¸ì œ**

â€‹	â€¢	R2ëŠ” R1ê³¼ **eBGP**ë¡œ 1.1.1.0 ë„¤íŠ¸ì›Œí¬ë¥¼ ë°›ìŒ

â€‹	â€¢	R2ëŠ” R3ì—ê²Œ **IBGP**ë¡œ ì „ë‹¬

â€‹	â€¢	**ë¬¸ì œ ë°œìƒ!**

â€‹	â€¢	IBGPì—ì„œëŠ” ë°›ì€ ì •ë³´ë¥¼ ë‹¤ë¥¸ IBGP ë„¤ì´ë²„(R4)ì—ê²Œ ë‹¤ì‹œ ì „ë‹¬í•  ìˆ˜ ì—†ìŒ ðŸ˜±

â€‹	â€¢	ì¦‰, **R4ëŠ” 1.1.1.0 ë„¤íŠ¸ì›Œí¬ë¥¼ ì•Œ ìˆ˜ ì—†ìŒ**



**âœ… Full Meshê°€ ìžˆì„ ë•Œ í•´ê²°**

â€‹	â€¢	R2, R3, R4ê°€ **ëª¨ë‘ ì§ì ‘ IBGP ë„¤ì´ë²„ ê´€ê³„ë¥¼ ë§ºìŒ**

â€‹	â€¢	R2 â†’ R3 (ë„¤ì´ë²„ ê´€ê³„)

â€‹	â€¢	R2 â†’ R4 (ë„¤ì´ë²„ ê´€ê³„)

â€‹	â€¢	R3 â†’ R4 (ë„¤ì´ë²„ ê´€ê³„)

â€‹	â€¢	**ì´ì œ R4ë„ 1.1.1.0ì„ í•™ìŠµí•  ìˆ˜ ìžˆìŒ!** ðŸŽ¯

**4. Full Mesh ì„¤ì • ë°©ë²•**



âœ” **ê° ë¼ìš°í„°ê°€ ë‹¤ë¥¸ ëª¨ë“  IBGP ë¼ìš°í„°ì™€ ë„¤ì´ë²„ ì„¤ì •**

âœ” ì˜ˆì œ ì½”ë“œ:

```
R2(config)# router bgp 234
R2(config-router)# neighbor 1.1.3.3 remote-as 234
R2(config-router)# neighbor 1.1.4.4 remote-as 234
R3(config)# router bgp 234
R3(config-router)# neighbor 1.1.2.2 remote-as 234
R3(config-router)# neighbor 1.1.4.4 remote-as 234
R4(config)# router bgp 234
R4(config-router)# neighbor 1.1.2.2 remote-as 234
R4(config-router)# neighbor 1.1.3.3 remote-as 234
```

âœ” **ê° ë„¤ì´ë²„ì˜ ë£¨í”„ë°± ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì•ˆì •ì„±ì„ ë†’ìž„**

```
neighbor 1.1.3.3 update-source loopback0
```

**5. Full Meshì˜ ë‹¨ì  & í•´ê²° ë°©ë²•**

| **ë¬¸ì œ**                                     | **í•´ê²° ë°©ë²•**                                        |
| -------------------------------------------- | ---------------------------------------------------- |
| **ë¼ìš°í„°ê°€ ë§Žì•„ì§€ë©´ ì„¤ì •ì´ ë„ˆë¬´ ë§Žì•„ì§**     | **Route Reflector(RR) ì‚¬ìš©** (í•œ ë¼ìš°í„°ê°€ ëŒ€ì‹  ì „ë‹¬) |
| **ë„¤ì´ë²„ê°€ ë§Žì„ìˆ˜ë¡ CPU & ë©”ëª¨ë¦¬ ë¶€ë‹´ ì¦ê°€** | **Confederation ì‚¬ìš©** (ASë¥¼ ìž‘ì€ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ”)     |

**6. í•µì‹¬ ì •ë¦¬**

| **ê°œë…**          | **ì„¤ëª…**                                                |
| ----------------- | ------------------------------------------------------- |
| **BGP Full Mesh** | ëª¨ë“  IBGP ë¼ìš°í„°ê°€ ì§ì ‘ ë„¤ì´ë²„ ê´€ê³„ë¥¼ ë§ºìŒ              |
| **ì™œ í•„ìš”?**      | IBGPëŠ” ë°›ì€ ì •ë³´ë¥¼ ë‹¤ì‹œ ì „ë‹¬í•˜ì§€ ì•ŠìŒ (ìŠ¤í”Œë¦¿ í˜¸ë¼ì´ì¦Œ) |
| **ë¬¸ì œ í•´ê²°ë²•?**  | ëª¨ë“  IBGP ë¼ìš°í„°ê°€ ì§ì ‘ ì—°ê²°ë˜ë„ë¡ ì„¤ì •                 |
| **ë‹¨ì **          | ë¼ìš°í„°ê°€ ë§Žì•„ì§€ë©´ ì„¤ì •ì´ ë³µìž¡í•´ì§                       |
| **ëŒ€ì•ˆ**          | Route Reflector(RR) ë˜ëŠ” Confederation ì‚¬ìš©             |

âœ… **í•œë§ˆë”” ìš”ì•½:**

â€œIBGPì—ì„œëŠ” ì •ë³´ë¥¼ ë°›ì€ ë¼ìš°í„°ê°€ ë‹¤ë¥¸ IBGP ë„¤ì´ë²„ì—ê²Œ ì „ë‹¬ ëª»í•¨ â†’ ëª¨ë“  ë¼ìš°í„°ê°€ ì§ì ‘ ì—°ê²° í•„ìš”!â€ ðŸš€

------



## ë£¨íŠ¸ ë¦¬í”Œë ‰í„°(Route Reflector) 389 395







------

## confederation