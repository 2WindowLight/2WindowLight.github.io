---
title: <h0>BGP Community</h0>
author: cotes   
categories: [cisco virtual cloud, 2025-02-21-cisco]
tags: [Network, Review]












---

# 2025-02-21 Review



### Secondary

```bash
R3(config)# int lo16
R3(config-if)# ip add 1.1.16.1 255.255.255.0
R3(config-if)# ip add 1.1.17.1 255.255.255.0 sec
R3(config-if)# ip add 1.1.18.1 255.255.255.0 sec
R3(config-if)# ip add 1.1.19.1 255.255.255.0 sec
R3(config-if)# exit
```

**“secondary” 키워드는 한 인터페이스에 두 개 이상의 IP 주소를 설정할 때, 기본(primary) IP 주소 외에 추가적인 IP 주소를 구성하기 위해 사용된다. 자세히 설명하면 다음과 같다.**

**기본(primary) IP와의 구분:**

* 인터페이스에 하나의 IP 주소를 설정하면 그 주소가 기본(primary) IP 주소로 간주된다.

* “secondary” 옵션을 사용하면, 해당 인터페이스에 추가 IP 주소(보조 주소)를 설정하게 되며, 이 보조 주소는 기본 주소와는 별개로 관리된다.

**용도 및 역할:**

* 하나의 인터페이스에서 여러 서브넷을 지원해야 할 때 사용된다. 예를 들어, R3의 Loopback16 인터페이스에 기본 주소 1.1.16.1/24가 설정되어 있고, 추가로 1.1.17.1/24, 1.1.18.1/24, 1.1.19.1/24를 보조 주소로 설정하면, 이 인터페이스는 여러 서로 다른 네트워크에 속하는 것으로 동작한다.

* 이 보조 주소들은 라우팅 테이블에 별도로 설치되어, 해당 네트워크에 대한 트래픽도 처리할 수 있다.

* 다만, 기본 주소와 달리 보조 주소는 주로 해당 인터페이스의 추가적인 네트워크 범위를 광고하기 위해 사용되며, 패킷 송신 시 기본적으로 기본 IP 주소가 소스 주소로 선택된다.

------

아래는 2025/02/21에 질문한 내용들을 토대로, 오늘 다룬 주요 용어와 개념, 그리고 관련 명령어들의 기능을 정리한 것이다.

**1. BGP (Border Gateway Protocol)**

​	•	**개념:**

인터넷의 자율 시스템(AS) 간에 경로 정보를 교환하는 데 사용되는 프로토콜이다.

​	•	**목적:**

정책 기반 라우팅, 경로 선택, 트래픽 엔지니어링 등 다양한 용도로 사용된다.

**2. BGP 커뮤니티 (BGP Community)**

​	•	**개념:**

BGP 경로에 부가적으로 첨부할 수 있는 선택적 속성(optional attribute)이다.

​	•	**역할:**

경로를 그룹화하거나 분류하여, 특정 정책(예: 필터링, 광고 제한, 트래픽 우선순위 변경)을 적용할 때 사용한다.

​	•	**예시:**

​	•	**no-export:** 외부 AS로 경로가 광고되지 않도록 한다.

​	•	**no-advertise:** 어떤 피어에게도 경로를 광고하지 않도록 한다.

​	•	**사용자 정의 값:** 예를 들어 “3:16”, “3:17” 등은 네트워크별로 세밀한 정책 제어에 활용된다.

**3. BGP 커뮤니티 리스트 (ip community-list)**

​	•	**개념:**

특정 커뮤니티 값을 필터링하거나 매치할 때 사용하는 리스트이다.

​	•	**기능:**

​	•	예: ip community-list 1 permit 3:16

​	•	커뮤니티 리스트 번호 1에 대해 “3:16” 값만 허용하도록 정의한다.

​	•	**용도:**

Route-map에서 match community 구문과 함께 사용하여, 특정 커뮤니티 값을 가진 경로에만 정책을 적용할 수 있다.

**4. Route-map**

​	•	**개념:**

BGP 업데이트에 대해 match 조건과 set 동작을 정의하는 정책 도구이다.

​	•	**구성:**

​	•	여러 시퀀스 번호(예: 10, 20, 30 등)로 구성되며, 각 시퀀스에서 조건을 검사하고 해당 조건에 맞으면 후속 동작을 적용한다.

​	•	**예시 명령어:**

​	•	route-map Map2 10

​	•	“Map2”라는 이름의 정책의 시퀀스 10을 시작한다.

​	•	match community 1

​	•	커뮤니티 리스트 1에 정의된 값(예, 3:16)을 가진 경로를 매치한다.

​	•	set local-preference 1000

​	•	매치된 경로의 local-preference 값을 1000으로 변경한다.

​	•	**용도:**

커뮤니티 값에 따라 경로의 우선순위나 다른 속성을 조정해, 정책 기반 라우팅 및 트래픽 엔지니어링을 수행할 수 있다.

**5. Match Community**

​	•	**개념:**

route-map 내에서 BGP 업데이트의 커뮤니티 속성이 특정 커뮤니티 리스트에 일치하는지 검사하는 구문이다.

​	•	**용도:**

커뮤니티 값이 특정 값(예, 3:16)인 경로에만 후속 set 동작을 적용하도록 한다.

**6. Set Community**

​	•	**개념:**

match 조건에 일치하는 경로에 대해 특정 커뮤니티 값을 부여하는 명령어이다.

​	•	**예시:**

​	•	set community 3:16

​	•	경로에 커뮤니티 “3:16”을 부여한다.

​	•	set community internet 3:16 3:17

​	•	경로에 “internet”과 함께 “3:16”, “3:17”을 부여한다.

​	•	**용도:**

부여된 커뮤니티 값은 이후 다른 라우터에서 경로 선택이나 정책 필터링에 활용될 수 있다.

**7. Prefix-list**

​	•	**개념:**

IP 프리픽스를 필터링하는 리스트로, route-map이나 다른 필터링 메커니즘에서 사용된다.

​	•	**예시 명령어:**

​	•	ip prefix-list List16 permit 1.1.16.0/24

​	•	List16은 오직 1.1.16.0/24 네트워크만을 허용한다.

​	•	**용도:**

route-map의 match 조건에서 특정 네트워크를 정확히 식별하기 위해 사용된다.

**8. neighbor send-community**

​	•	**개념:**

기본적으로 BGP는 커뮤니티 속성을 피어에게 전송하지 않는데, 이 명령어를 사용하면 커뮤니티 속성이 포함된 업데이트를 전송할 수 있다.

​	•	**예시 명령어:**

​	•	neighbor 1.1.2.2 send-community

​	•	R1이 피어 1.1.2.2에게 업데이트를 보낼 때, 커뮤니티 속성을 포함시킨다.

​	•	**용도:**

피어에게 커뮤니티 값이 포함되어 전달되어, 정책 필터링이나 경로 선택에 활용될 수 있다.

**9. Local-preference**

​	•	**개념:**

AS 내부에서 경로 선택 시 사용되는 BGP 속성으로, 값이 높을수록 선호된다.

​	•	**용도:**

route-map을 통해 특정 커뮤니티 값을 가진 경로의 local-preference를 변경하여, AS 내에서 우선순위를 조정할 수 있다.

​	•	**예시:**

​	•	set local-preference 1000

​	•	경로의 local-preference 값을 1000으로 설정하여, 기본(local-preference 기본값 100)보다 더 높은 우선순위를 부여한다.

**10. no ip community-list**

​	•	**개념:**

기존에 구성된 커뮤니티 리스트 항목을 삭제하는 명령어이다.

​	•	**예시:**

​	•	no ip community-list 1 permit 3

​	•	커뮤니티 리스트 번호 1에 대해 “3” 값을 허용하는 항목을 삭제한다.

​	•	**용도:**

필요 없는 항목을 제거하고, 원하는 커뮤니티 값만 유지하도록 한다.

**11. AS 내부 정책 설정 (FromAs3, ToAs3, FromAs4, ToAs4)**

​	•	**구성 목적:**

AS 내부에서 들어오고 나가는 경로에 대해 커뮤니티 값을 기반으로 정책을 적용하여 경로를 조정한다.

​	•	**예시 구성 (R1):**

​	•	**FromAs3 route-map:**

​	•	set community 12:34를 적용하여 AS 3로부터 수신되는 업데이트에 대해 커뮤니티 값을 변경한다.

​	•	**ToAs3 route-map:**

​	•	match community 34를 사용하여, 커뮤니티 값 12:34가 포함된 경로만 내보내도록 한다.

​	•	**용도:**

커뮤니티를 이용해 특정 AS(예, AS 3, AS 4)와의 경로에 대해 정책적 제어(예, local-preference 조정)를 수행한다.

13. 기타 관련 용어**

​	•	**BGP Default Route:**

기본 경로(0.0.0.0/0)를 BGP에 광고하여, 상세 경로 정보 없이도 “모든 미지정 목적지”로의 트래픽을 처리할 수 있도록 하는 방법이다.

​	•	**Redistribute Static, default-information originate, neighbor default-originate:**

디폴트 루트 광고와 관련된 명령어들로, 정적 라우트를 BGP에 재분배하거나, 디폴트 정보를 강제로 originate하도록 설정한다.

​	•	**ip bgp new-format:**

BGP 커뮤니티 출력 형식을 최신 형식으로 전환하여, 확장 커뮤니티나 다중 커뮤니티 값을 명확하게 표시하도록 한다.

**결론**



오늘 다룬 주요 용어들은 BGP의 경로 정책 제어 및 트래픽 엔지니어링에 핵심적인 역할을 한다.

​	•	**BGP 커뮤니티**는 경로에 태그를 붙여 그룹화 및 정책 적용을 가능하게 하며,

​	•	**커뮤니티 리스트와 route-map**을 통해 특정 커뮤니티 값을 매치하고, 경로의 local-preference 등 속성을 조정할 수 있다.

​	•	**neighbor send-community**는 피어에게 커뮤니티 속성을 전송하도록 설정하여, 피어 간에 동일한 정책을 적용할 수 있게 한다.

​	•	**Secondary IP**는 하나의 인터페이스에서 여러 네트워크를 지원하기 위해 사용된다.



이와 같이, 각 용어와 명령어의 기능을 명확히 이해함으로써, BGP 기반 정책 설정과 경로 제어를 보다 세밀하게 구현할 수 있다.
